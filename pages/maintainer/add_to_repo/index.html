<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="Rush" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic"><title data-react-helmet="true">Adding projects to a repo | Rush</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://rushjs.io/pages/maintainer/add_to_repo/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Adding projects to a repo | Rush"><meta data-react-helmet="true" name="description" content="This continues the tutorial that started with &quot;Setting up a new repo&quot;. (To see a fully worked out sample based on these steps, take a look at the rush-example repo on GitHub.)"><meta data-react-helmet="true" property="og:description" content="This continues the tutorial that started with &quot;Setting up a new repo&quot;. (To see a fully worked out sample based on these steps, take a look at the rush-example repo on GitHub.)"><link data-react-helmet="true" rel="icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://rushjs.io/pages/maintainer/add_to_repo/"><link data-react-helmet="true" rel="alternate" href="https://rushjs.io/pages/maintainer/add_to_repo/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://rushjs.io/pages/maintainer/add_to_repo/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4e089977.css">
<link rel="preload" href="/assets/js/runtime~main.92aede24.js" as="script">
<link rel="preload" href="/assets/js/main.3dab50c5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_dnh5">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/rush-horiz.svg" alt="Rush" class="themedImage_enBv themedImage--light_zZCg"><img src="/images/rush-horiz.svg" alt="Rush" class="themedImage_enBv themedImage--dark_vTri"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pages/intro/welcome/">Docs</a><a class="navbar__item navbar__link" href="/pages/news/">News</a><a class="navbar__item navbar__link" href="/pages/advanced/api/">API</a><a class="navbar__item navbar__link" href="/pages/contributing/">GitHub</a><a class="navbar__item navbar__link" href="/pages/help/support/">Help</a><div class="toggle_qtsb toggle_Unyd toggleDisabled_FCYL"><div class="toggleTrack_-21w" role="button" tabindex="-1"><div class="toggleTrackCheck_e+4S"><span class="toggleIcon_h7wk">🌜</span></div><div class="toggleTrackX_tdrT"><span class="toggleIcon_h7wk">🌞</span></div><div class="toggleTrackThumb_bfyz"></div></div><input type="checkbox" class="toggleScreenReader_JCXT" aria-label="Switch between dark and light mode"></div><div class="searchBox_N6S6"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_H8Xm"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_DhKp" type="button"></button><aside class="docSidebarContainer_xEkI"><div class="sidebar_rYjd"><nav class="menu thin-scrollbar menu_TBxP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/intro/welcome/">Welcome to Rush!</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/intro/why_mono/">Why one big repo⁈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/intro/get_started/">Getting started</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Developer tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/developer/new_developer/">Getting started as a developer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/developer/everyday_commands/">Everyday commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/developer/modifying_package_json/">Modifying package.json</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/developer/other_commands/">Other helpful commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/developer/tab_completion/">Configuring tab completion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/developer/selecting_subsets/">Selecting subsets of projects</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active menuLinkText_oOyz">Maintainer tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/setup_new_repo/">Setting up a new repo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pages/maintainer/add_to_repo/">Adding projects to a repo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/enabling_ci_builds/">Enabling CI builds</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/recommended_settings/">Recommended settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/package_managers/">NPM vs PNPM vs Yarn</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/setup_policies/">Enabling policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/git_hooks/">Installing Git hooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/enabling_prettier/">Enabling Prettier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/custom_commands/">Custom commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/publishing/">Publishing packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/deploying/">Deploying projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/build_cache/">Enabling the build cache (experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/maintainer/npm_registry_auth/">NPM registry authentication</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Best practices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/best_practices/change_logs/">Authoring change logs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Advanced topics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/config_files/">Config file reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/phantom_deps/">Phantom dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/npm_doppelgangers/">NPM doppelgangers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/preferred_versions/">Preferred versions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/incremental_builds/">Incremental builds</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/watch_mode/">Using watch mode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/installation_variants/">Installation variants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/advanced/api/">The &quot;rush-lib&quot; API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Command reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_add/">rush add</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_build/">rush build</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_change/">rush change</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_check/">rush check</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_deploy/">rush deploy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_init/">rush init</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_init-autoinstaller/">rush init-autoinstaller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_init-deploy/">rush init-deploy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_install/">rush install</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_link/">rush link</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_list/">rush list</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_publish/">rush publish</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_purge/">rush purge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_rebuild/">rush rebuild</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_scan/">rush scan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_setup/">rush setup (experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_tab-complete/">rush tab-complete</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_unlink/">rush unlink</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_update/">rush update</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_update-autoinstaller/">rush update-autoinstaller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_update-cloud-credentials/">rush update-cloud-credentials (experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_version/">rush version</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/commands/rush_write-build-cache/">rush write-build-cache (experimental)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Config reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/environment_vars/">Environment variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/npmrc/">.npmrc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/npmrc-publish/">.npmrc-publish</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/artifactory_json/">artifactory.json (experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/build-cache_json/">build-cache.json (experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/command-line_json/">command-line.json</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/common-versions_json/">common-versions.json</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/deploy_json/">deploy.json</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/experiments_json/">experiments.json</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/rush_json/">rush.json</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/rush-project_json/">rush-project.json (experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/configs/version-policies_json/">version-policies.json</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_oOyz">Help</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/help/support/">Getting support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/help/faq/">Frequently Asked Questions (FAQ)</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_2rn9"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_47sW"><div class="docItemContainer_iuSI"><article><div class="tocCollapsible_w5bN theme-doc-toc-mobile tocMobile_s7LL"><button type="button" class="clean-btn tocCollapsibleButton_0GVP">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Adding projects to a repo</h1></header><p><em>This continues the tutorial that started with &quot;<a href="/pages/maintainer/setup_new_repo/">Setting up a new repo</a>&quot;. (To see a fully worked out sample based on these steps, take a look at the <a href="https://github.com/microsoft/rush-example" target="_blank" rel="noopener noreferrer">rush-example</a> repo on GitHub.)</em></p><h2 class="anchor anchorWithStickyNavbar_kfcd" id="step-4-add-your-first-project">Step 4: Add your first project<a class="hash-link" href="#step-4-add-your-first-project" title="Direct link to heading">​</a></h2><p>Rather than trying to add all your projects to <strong>rush.json</strong> all at once, we recommend adding and validating each project one at a time. Recall that your projects form a <a href="https://en.wikipedia.org/wiki/Dependency_graph" target="_blank" rel="noopener noreferrer">dependency graph</a>, so start with the &quot;leaf&quot; projects (that don&#x27;t depend on anything else in the repo), and then work your way backwards. If you encounter any errors, this approach makes it easier to understand and investigate them. If you commit each added project individually, this will also make your Git history more understandable to others.</p><p>For this example, let&#x27;s start by adding our hypothetical <strong>my-toolchain</strong> project, which is needed to build everything else. Since we&#x27;ll be conforming to the &quot;category folders&quot; model (described in the <strong>rush.json</strong> comments), we&#x27;ll move this project under a &quot;tools&quot; category folder. Eventually we&#x27;ll plan for other NodeJS tooling packages to go in the &quot;tools&quot; folder:</p><div class="codeBlockContainer_YZw5 theme-code-block"><div class="codeBlockContent_7FbP"><pre tabindex="0" class="prism-code language-undefined codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ mkdir tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ cd tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools$ cp -R ~/my-toolchain/ .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools$ cd my-toolchain</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><p>Next we need to delete project-specific files that are centrally coordinated in a monorepo:</p><ul><li>Delete the local shrinkwrap file, since it&#x27;s superseded by Rush&#x27;s common shrinkwrap file.</li><li>Consider deleting the project&#x27;s <strong>.npmrc</strong> file, since Rush operations always use <strong>common/config/rush/.npmrc</strong></li><li>Consider deleting the project&#x27;s Git config files unless they contain rules that are really specific to that project</li></ul><div class="codeBlockContainer_YZw5 theme-code-block"><div class="codeBlockContent_7FbP"><pre tabindex="0" class="prism-code language-undefined codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools/my-toolchain$ rm -f shrinkwrap.yaml npm-shrinkwrap.json package-lock.json yarn.lock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools/my-toolchain$ rm -f .npmrc          # (if it makes sense)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools/my-toolchain$ rm -f .gitattributes  # (if it makes sense)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools/my-toolchain$ rm -f .gitignore      # (if it makes sense)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><blockquote><p><strong>More about the &quot;shrinkwrap file&quot;</strong></p><p>Depending on your package manager, the shrinkwrap file may be called <strong>shrinkwrap.yaml</strong>,
<strong>npm-shrinkwrap.json</strong>, <strong>package-lock.json</strong>, or <strong>yarn.lock</strong>. (Some package managers use the
term &quot;lock file&quot;, although it has nothing to do with file locking. In this documentation we will
generically refer to it as a &quot;shrinkwrap file&quot; since we don&#x27;t know which package manager you will choose.)</p><p>Normally the package manager creates a shrinkwrap file in each project folder, but in a Rush repo
there is a single &quot;common&quot; shrinkwrap file that describes the entire repo. It will be stored in
the <strong>common/config/rush</strong> folder, and should be committed to Git. Consolidating all dependency
information in a single shrinkwrap file has many benefits for reducing merge conflicts, reviewing diffs,
and improving installation speed.</p></blockquote><p>Commit the new project files to Git:</p><div class="codeBlockContainer_YZw5 theme-code-block"><div class="codeBlockContent_7FbP"><pre tabindex="0" class="prism-code language-undefined codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo/tools/my-toolchain$ cd ../..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ git add .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ git commit -m &quot;Adding my-toolchain&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_kfcd" id="step-5-running-your-first-rush-update">Step 5: Running your first &quot;rush update&quot;<a class="hash-link" href="#step-5-running-your-first-rush-update" title="Direct link to heading">​</a></h2><p>After copying over the project files, we need to edit <strong>rush.json</strong> and add an entry like this under the <code>projects</code> inventory:</p><div class="codeBlockContainer_YZw5 language-jsonc theme-code-block"><div class="codeBlockContent_7FbP jsonc"><pre tabindex="0" class="prism-code language-jsonc codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;projects&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;packageName&quot;: &quot;my-toolchain&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;projectFolder&quot;: &quot;tools/my-toolchain&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><p>This tells Rush that it should manage this project.</p><blockquote><p><strong>Why can&#x27;t Rush automatically detect my projects?</strong></p><p>Rush does not automatically discover projects using wildcards. We have a few motivations for this
design decision:</p><ol><li>Depth-first scans are expensive, particularly when tools need to repeatedly collect the list.</li><li>On a caching CI machine, scans can accidentally pick up files left behind from a previous build.</li><li>It&#x27;s useful to have a centralized inventory of all projects and their important metadata.
For example, this makes the approval/policy features more intuitive.</li></ol></blockquote><p>Next, run <code>rush update</code> to install the dependencies of <strong>my-toolchain</strong>. This command can be run in
any subfolder of the repo folder that contains rush.json:</p><div class="codeBlockContainer_YZw5 theme-code-block"><div class="codeBlockContent_7FbP"><pre tabindex="0" class="prism-code language-undefined codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ rush update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ git add .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~/my-repo$ git commit -m &quot;rush update&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><p>Since this is the first project for the repo, you&#x27;ll notice that <code>rush update</code> creates several new files:</p><ul><li><strong>common/config/rush/shrinkwrap.yaml</strong>: The common shrinkwrap file (here we&#x27;re assuming PNPM package manager)</li><li><strong>common/scripts/install-run-rush.js</strong>: Used by CI jobs to bootstrap the Rush tool in a reliable way</li><li><strong>common/scripts/install-run.js</strong>: Used by CI jobs to bootstrap arbitrary tools in a reliable way</li></ul><h2 class="anchor anchorWithStickyNavbar_kfcd" id="step-6-verify-that-the-new-project-builds">Step 6: Verify that the new project builds<a class="hash-link" href="#step-6-verify-that-the-new-project-builds" title="Direct link to heading">​</a></h2><p>In order to build your projects, Rush will look for a <code>&quot;build&quot;</code> script in the <code>&quot;scripts&quot;</code> section of your <strong>package.json</strong> file. In our example from <a href="https://github.com/microsoft/rush-example" target="_blank" rel="noopener noreferrer">rush-example</a>, the project builds using a simple shell script <code>&quot;rimraf ./lib/ &amp;&amp; tsc&quot;</code>:</p><div class="codeBlockContainer_YZw5 language-json theme-code-block"><div class="codeBlockContent_7FbP json"><pre tabindex="0" class="prism-code language-json codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-toolchain&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;An example toolchain used to build projects in this repo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;license&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MIT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;bin&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;my-build&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bin/my-build.js&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;scripts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;build&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rimraf ./lib/ &amp;&amp; tsc&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;colors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^1.3.2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;devDependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;@types/node&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^10.9.4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;rimraf&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^2.6.2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;typescript&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^3.0.3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><p>There are a few things to keep in mind when creating a <code>&quot;build&quot;</code> script:</p><ul><li><p>Rush will normally use your system PATH environment variable to find the script commands. However, if you specify a single-word command like &quot;gulp&quot; or &quot;make&quot;, Rush will first look for the program in the <code>common\temp\node_modules\.bin</code> folder.</p></li><li><p>If the process returns a non-zero exit status, Rush will assume there was a failure and will block downstream builds.</p></li><li><p>If the command writes anything to the <code>stderr</code> stream, Rush will interpret this to mean that at least one error or warning was reported. This will break the build. (This is by design -- if you allow people to merge PRs that &quot;cry wolf&quot;, pretty soon you will find that so many warnings have accumulated that nobody even reads them any more.) Some tooling libraries (e.g. Jest) write to <code>stderr</code> as part of their normal operation; you will need to <a href="https://github.com/microsoft/rushstack-legacy/blob/main/core-build/gulp-core-build/src/tasks/JestReporter.ts#L14" target="_blank" rel="noopener noreferrer">redirect their output</a>.</p></li><li><p>If certain projects don&#x27;t need to be processed by <code>rush build</code>, you still need a <code>build</code> entry. Set the value to an empty string (<code>&quot;&quot;</code>) and Rush will ignore it.</p></li></ul><p>Now let&#x27;s try building your project. From anywhere under the folder containing <strong>rush.json</strong>, run this command (which builds all projects in the repo):</p><div class="codeBlockContainer_YZw5 theme-code-block"><div class="codeBlockContent_7FbP"><pre tabindex="0" class="prism-code language-undefined codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">$ rush build</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><p>Rush provides a lot of command-line switches for building projects. See <a href="/pages/commands/rush_build/">rush build</a> and <a href="/pages/commands/rush_rebuild/">rush rebuild</a> for details.</p><blockquote><p><strong>Phantom dependency errors</strong></p><p>Rush and PNPM use symlinks to prevent projects from importing <a href="/pages/advanced/phantom_deps/">phantom dependencies</a>.
If an NPM dependency is not declared in your <strong>package.json</strong> file, a runtime error may occur if your project tries to
import it. These phantom dependency errors are one of the most common issues when migrating an existing project into
a Rush monorepo. Generally the fix is simply to add the missing dependency to your <strong>package.json</strong> file.</p><p>The <a href="/pages/commands/rush_scan/">rush scan</a> command is a quick way to detect these problems.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_kfcd" id="step-7-adding-more-projects">Step 7: Adding more projects<a class="hash-link" href="#step-7-adding-more-projects" title="Direct link to heading">​</a></h2><p>You can add more projects by following the same operations from Step 4. In our example, we would add <strong>my-controls</strong> next (because it depends on <strong>my-toolchain</strong>), and then <strong>my-application</strong> last (because it depends on everything). We proactively added a couple more category folders (&quot;libraries&quot; and &quot;apps&quot;) since we expect more of these types of things in our scenario. The filled out <code>&quot;projects&quot;</code> section looks like this:</p><div class="codeBlockContainer_YZw5 language-jsonc theme-code-block"><div class="codeBlockContent_7FbP jsonc"><pre tabindex="0" class="prism-code language-jsonc codeBlock_RCc7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_OuWf"><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;projects&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;packageName&quot;: &quot;my-app&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;projectFolder&quot;: &quot;apps/my-app&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;packageName&quot;: &quot;my-controls&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;projectFolder&quot;: &quot;libraries/my-controls&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;reviewCategory&quot;: &quot;production&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;packageName&quot;: &quot;my-toolchain&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;projectFolder&quot;: &quot;tools/my-toolchain&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;reviewCategory&quot;: &quot;tools&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_XkHl clean-btn">Copy</button></div></div><p>Once you have all your projects added and building without errors, you may consider enabling other optional features. The config files contain lots of snippets that you can uncomment to get started. The <a href="https://github.com/microsoft/rush-example" target="_blank" rel="noopener noreferrer">rush-example</a> repo uses some of these snippets.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/rushstack-websites/tree/main/websites/rushjs.io/docs/pages/maintainer/add_to_repo.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_3s-y" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_n4Pj"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/pages/maintainer/setup_new_repo/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Setting up a new repo</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/pages/maintainer/enabling_ci_builds/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Enabling CI builds</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_78-- thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#step-4-add-your-first-project" class="table-of-contents__link toc-highlight">Step 4: Add your first project</a></li><li><a href="#step-5-running-your-first-rush-update" class="table-of-contents__link toc-highlight">Step 5: Running your first &quot;rush update&quot;</a></li><li><a href="#step-6-verify-that-the-new-project-builds" class="table-of-contents__link toc-highlight">Step 6: Verify that the new project builds</a></li><li><a href="#step-7-adding-more-projects" class="table-of-contents__link toc-highlight">Step 7: Adding more projects</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2022 Microsoft</div></div></div></footer></div>
<script src="/assets/js/runtime~main.92aede24.js"></script>
<script src="/assets/js/main.3dab50c5.js"></script>
</body>
</html>